CREATE SCHEMA FORTESDB;

USE FORTESDB;

CREATE TABLE IF NOT EXISTS FORNECEDOR (
idFORNECEDOR INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
FORNECEDORcnpj VARCHAR(14) UNIQUE NOT NULL,
FORNECEDORrazaosocial VARCHAR(100) NOT NULL,
FORNECEDORcep VARCHAR(9),
FORNECEDORlogradouro VARCHAR(255),
FORNECEDORcidade VARCHAR(50),
FORNECEDORestado VARCHAR(2),
FORNECEDORpais VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS OBRA (
idOBRA INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
OBRAnum_projeto BIGINT UNIQUE,
OBRAdt_inicio DATE,
OBRAprazo INT,
OBRAcep VARCHAR(9),
OBRAlogradouro VARCHAR(255),
OBRAcidade VARCHAR(50),
OBRAestado VARCHAR(2),
OBRApais VARCHAR(50),
FORNECEDOR_idFORNECEDOR INT,
CONSTRAINT fk_OBRA_FORNECEDOR
FOREIGN KEY (FORNECEDOR_idFORNECEDOR) 
REFERENCES FORNECEDOR (idFORNECEDOR)
);

CREATE TABLE IF NOT EXISTS EQUIPE (
idEQUIPE INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
EQUIPEnome VARCHAR(100) NOT NULL,
OBRA_idOBRA INT,
CONSTRAINT fk_EQUIPE_OBRA
FOREIGN KEY (OBRA_idOBRA) 
REFERENCES OBRA (idOBRA)
);

CREATE TABLE IF NOT EXISTS REFEICAO (
idREFEICAO INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
REFEICAOtipo VARCHAR(50) NOT NULL,
REFEICAOvlr_dia_util DOUBLE NOT NULL,
REFEICAOvlr_dia_nao_util DOUBLE NOT NULL,
REFEICAOhora_inicio TIME NOT NULL,
REFEICAOhora_termino TIME  NOT NULL
);

CREATE TABLE IF NOT EXISTS FUNCIONARIO (
idFUNCIONARIO INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
FUNCIONARIOcpf VARCHAR(11) UNIQUE NOT NULL,
FUNCIONARIOmatricula VARCHAR(50) UNIQUE NOT NULL,
FUNCIONARIOnome VARCHAR(100) NOT NULL,
FUNCIONARIOidcard VARCHAR(50) UNIQUE NOT NULL,
FUNCIONARIOcargo VARCHAR(100),
EQUIPE_idEQUIPE INT,
CONSTRAINT fk_FUNCIONARIO_EQUIPE	
FOREIGN KEY (EQUIPE_idEQUIPE)
REFERENCES EQUIPE (idEQUIPE)
);

CREATE TABLE IF NOT EXISTS USUARIO (
idUSUARIO INT NOT NULL PRIMARY KEY UNIQUE auto_increment,
USUARIOuser VARCHAR(30) UNIQUE NOT NULL,
USUARIOsenha VARCHAR(100) NOT NULL,
USUARIOtipo VARCHAR(50) NOT NULL,
FUNCIONARIO_idFUNCIONARIO INT,
FORNECEDOR_idFORNECEDOR int,
CONSTRAINT fk_USUARIO_FUNCIONARIO
FOREIGN KEY (FUNCIONARIO_idFUNCIONARIO)
REFERENCES FUNCIONARIO (idFUNCIONARIO),
CONSTRAINT fk_USUARIO_FORNECEDOR
FOREIGN KEY (FORNECEDOR_idFORNECEDOR)
REFERENCES FORNECEDOR (idFORNECEDOR)
);
 


CREATE TABLE IF NOT EXISTS ATENDIMENTO(
idATENDIMENTO INT PRIMARY KEY NOT NULL auto_increment,
ATENDIMENTOdata DATE,
ATENDIMENTOhora TIME,
REFEICAO_idREFEICAO INT,
FUNCIONARIO_idFUNCIONARIO INT,
OBRA_idOBRA INT,
CONSTRAINT fk_ATENDIMENTO_REFEICAO
FOREIGN KEY (REFEICAO_idREFEICAO)
REFERENCES REFEICAO (idREFEICAO),
CONSTRAINT fk_ATENDIMENTO_FUNCIONARIO
FOREIGN KEY (FUNCIONARIO_idFUNCIONARIO)
REFERENCES FUNCIONARIO (idFUNCIONARIO),
CONSTRAINT fk_ATENDIMENTO_OBRA
FOREIGN KEY (OBRA_idOBRA)
REFERENCES OBRA (idOBRA)
);
